<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="src/Pizzicato.min.js"></script>
  <!-- <script src="src/simpleTones.js"></script> -->
  <title>Audio Test</title>
</head>
<body>
  <h1>This is a test page for playing audio.</h1>
  <h2>Test: <span id="testid"></span></h2>
  <button onclick="testAudio()">Play</button>
  <!-- <button onclick="louder()">Louder!</button> -->
  <!-- <button onclick="softer()">Softer...</button> --> 
  <button onclick="stop()">Stop</button>
  <button onclick="nextSound()">&#x2190;</button>
  <button onclick="nextSound()">&#x2192;</button>
  <script>
    /*
    function testAudio() {
      playTone("A#4", "sawtooth", 5);
    }
    */

    // FREQUENCIES
    /*
        Why these? Mainly because according to https://www.teachmeaudio.com/mixing/techniques/audio-spectrum/ values, the audible ~flexible~ boundaries for higher and lower audible sounds by the masses are the lower hF and higher lF bounds below respectively.
    */
    const highFreqs = [17500, 16000, 14500, 13000, 11500, 10000, 8500, 7000, 5500];
    const lowFreqs = [10, 30, 65, 100, 135, 170, 205];
    const freqs = highFreqs.concat(lowFreqs).sort(function(i, j){
        return (Math.random() * 2) - 1;
    });
    // console.log(freqs)

    // INTENSITIES (VOLUME)
    var intensities = [0.5]; //[0.125, 0.250, 0.5, 0.75, 0.875];
 
    var whiteNoise = new Pizzicato.Sound(function(e) {
        var output = e.outputBuffer.getChannelData(0);
        for (var i = 0; i < e.outputBuffer.length; i++)
            output[i] = Math.random();
        }
    );
 
    // window.hci = {};
    frequencyOptionCount = 0;
    intensityOptionCount = 0;  
    testValue = freqs.length*frequencyOptionCount + intensityOptionCount + 1;
    
    var s = null;
 
    function testAudio() {
      s = new Pizzicato.Sound({
        source: 'wave',
        options: {
            type: 'sine',
            frequency: freqs[frequencyOptionCount],
            volume: intensities[intensityOptionCount],
        }
      });
      s.play();
    }

    function cleanAudio() {
        whiteNoise.play();
        setTimeout(function(){ 
            whiteNoise.stop(); 
        }, 5000);
    }

    function nextSound() {
        var fOC = frequencyOptionCount + 1;
        var iOC = intensityOptionCount + 1;
        
        if (fOC >= freqs.length && iOC >= intensities.length) {
            alert("Test is Complete!");
        } else if (iOC >= intensities.length) {
            frequencyOptionCount = fOC;
            intensityOptionCount = 0;
        } else {
            intensityOptionCount = iOC;
            frequencyOptionCount = fOC; 
        }
    }

    function stop() {
        s.stop();
    }

  </script>
</body>
</html>
